{% extends "students/base.html" %}
{% load static from staticfiles %}
{% block meta_title %}Студенты{% endblock meta_title %}
{% block title %}База студентов{% endblock title %}
{% block content %}



<!-- Add Students Button-->
<a class="btn btn-primary" href="{% url "students_add" %}">Добавить студента</a>



    <!-- Start Students Listing -->

<table class="table table-hover table-striped">
    {% with order_by=request.GET.order_by reverse=request.GET.reverse %}
    <thead>
    <tr>
        <th><a heref='#'>№</a></th>
        <th>Фото</th>
        <th><a href="{% url 'home' %}?order_by=last_name{% if order_by == 'last_name' and reverse != '1' %}&amp;reverse=1
        {% endif %}">
            Фамилия
            {% if order_by == 'last_name' and reverse != '1' %}&uarr;
            {% elif order_by == 'last_name' and reverse == '1' %}&darr;
          {% endif %}
            </a></th>
        <th><a href="{% url 'home' %}?order_by=first_name{% if order_by == 'first_name' and reverse != '1' %}&amp;reverse=1
        {% endif %}">Имя
            {% if order_by == 'first_name' and reverse != '1' %}&uarr;
            {% elif order_by == 'first_name' and reverse == '1' %}&darr;
          {% endif %}
            </a></th>
        <th><a href="{% url 'home' %}?order_by=ticket{% if order_by == 'ticket' and reverse != '1' %}&amp;reverse=1
        {% endif %}">№ Билета
            {% if order_by == 'ticket' and reverse != '1' %}&uarr;
            {% elif order_by == 'ticket' and reverse == '1' %}&darr;
          {% endif %}
            </a></th>
        <th>Действие</th>
    </tr>
    </thead>
    {% endwith %}
    <tbody>
        {% for student in students %}
        <tr>
            <td>{{ forloop.counter }}</td>
            {% if student.photo %}
            <td><img height="=30" width="30"
                     src="{{ student.photo.url }}" class="rounded-circle" /> </td>
            {% else %}
            <td><img height="=30" width="30"
                     src="{% static "img/default_user.png" %}" class="rounded-circle" /> </td>
            {% endif %}
            <td><a heref="{% url "students_edit" student.id %}">{{student.last_name }}</td>
            <td><a heref="{% url "students_edit" student.id %}">{{student.first_name}}</td>
            <td>{{student.ticket}}</td>
            <td>
                <div class="=btn-group">
                    <button class="btn btn-default dropdown-toggle"
                            type="button" data-toggle="dropdown">Действие
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu">
                        <li><a href="/jornal/1{{ student.id}}">Посещение</a>
                        </li>
                        <li>
                            <a href="{% url "students_edit" student.id %}">Редактировать</a>
                        </li>
                        <li>
                            <a href="{% url "students_delete" student.id %}">Удалить</a>
                        </li>
                    </ul>
                </div>
            </td>
        </tr>
    <tr>
        </tr>
        {%endfor%}
    </tbody>
</table>
<!-- End Students List -->

    <!-- Add Pagitnation-->

    {% if students.has_other_pages %}
    {% with order_by=request.GET.order_by reverse=request.GET.reverse number_on_page=request.GET.number_on_page %}

    <!-- Example single danger button -->
<div class="btn-group">
  <button type="button" class="btn btn-light" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
   Количество на странице {{ students.paginator.per_page}}
  </button>
  <div class="dropdown-menu">
    <a class="dropdown-item" href="{% url 'home' %}?page=1&amp;order_by={{ order_by }}&amp;reverse={{ reverse }}&amp;number_on_page=1">1</a>
    <a class="dropdown-item" href="{% url 'home' %}?page=1&amp;order_by={{ order_by }}&amp;reverse={{ reverse }}&amp;number_on_page=2">2</a>
    <a class="dropdown-item" href="{% url 'home' %}?page=1&amp;order_by={{ order_by }}&amp;reverse={{ reverse }}&amp;number_on_page=5">5</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="{% url 'home' %}?page=1&amp;order_by={{ order_by }}&amp;reverse={{ reverse }}&amp;number_on_page={{ students.paginator.count}}">ALL</a>
  </div>
</div>


    <nav aria-label="...">
        <ul class="pagination">
            <li class="page-item">
              <a class="page-link" href="{% url 'home' %}?page=1&amp;order_by={{ order_by }}&amp;reverse={{ reverse }}&amp;number_on_page={{number_on_page}}">&laquo;</a>
            </li>
            {% for p in students.paginator.page_range %}
            <li {% if students.number == p %}class="page-item active"{% endif %}><a class="page-link" href="{% url "home" %}?page={{ p }}&amp;order_by={{ order_by }}&amp;order_by={{ order_by }}&amp;reverse={{reverse }}&amp;number_on_page={{number_on_page}}">{{p}}</a></li>

            {% endfor %}
            <li class="page-item">
              <a class="page-link" href="{% url "home" %}?page={{ students.paginator.num_pages}}&amp;order_by=={{ order_by }}&amp;reverse={{ reverse }}&amp;number_on_page={{number_on_page}}">&raquo;</a>
            </li>

            <li class="page-item"><a class="page-link" href="#">Total pages {{ students.paginator.num_pages}}</a></li>

        </ul>
    </nav>

    {% endwith %}
    {% endif %}
{% endblock content %}
